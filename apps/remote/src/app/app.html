<!-- Remote Application Layout -->
<div class="remote-container">
  <!-- Navigation Bar (10%) -->
  <mat-toolbar color="primary" class="remote-nav-bar">
    <span class="header-title">ðŸ“± SAHAR TV Remote</span>
    <button mat-icon-button (click)="onHomeClick()">
      <mat-icon>home</mat-icon>
    </button>

    <div class="breadcrumb" *ngIf="navigation$ | async as nav">
      <span *ngFor="let crumb of nav.breadcrumb; let i = index">
        <span *ngIf="i > 0"> > </span>
        <span [class.active]="i === nav.breadcrumb.length - 1">{{ crumb }}</span>
      </span>
    </div>

    <span class="spacer"></span>

    <span class="connection-status">
      {{connectionStatus === 'connected' ? 'ðŸŸ¢ Connected' : 
        connectionStatus === 'connecting' ? 'ðŸŸ¡ Connecting...' : 'ðŸ”´ Disconnected'}}
    </span>

    <button mat-icon-button (click)="onBackClick()" 
            *ngIf="(navigation$ | async)?.canGoBack">
      <mat-icon>arrow_back</mat-icon>
    </button>
  </mat-toolbar>

  <!-- Navigation Content (only when connected) -->
  @if (connectionStatus === 'connected') {
    <div class="navigation-content">
      
      <!-- Navigation Breadcrumb -->
      <div class="breadcrumb">
        <button mat-button (click)="navigateToPerformers()" 
                [class.active]="currentLevel === 'performers'">
          ðŸ‘¥ Performers
        </button>
        
        @if (currentPerformer) {
          <span class="separator">â€º</span>
          <button mat-button (click)="navigateToVideos(currentPerformer.id)" 
                  [class.active]="currentLevel === 'videos'">
            ðŸ“¹ Videos
          </button>
        }
        
        @if (currentVideo) {
          <span class="separator">â€º</span>
          <button mat-button (click)="navigateToScenes(currentVideo.id)" 
                  [class.active]="currentLevel === 'scenes'">
            ðŸŽ¬ Scenes
          </button>
        }
        
        @if (currentScene) {
          <span class="separator">â€º</span>
          <span class="current-scene">ðŸŽ¯ Scene {{currentScene.id}}</span>
        }
      </div>

      <!-- Component Content Areas -->
      @switch (currentLevel) {
        
        @case ('performers') {
          <shared-performers-grid
            [performers]="currentPerformers"
            [selectedPerformerId]="currentPerformer?.id"
            [clientType]="'remote'"
            (performerSelected)="navigateToPerformer($event)">
          </shared-performers-grid>
        }
        
        @case ('videos') {
          <shared-videos-grid
            [videos]="currentVideos"            
            [clientType]="'remote'"
            [showBreadcrumb]="true"
            (videoSelected)="navigateToVideo($event)"
            (backToPerformers)="navigateToPerformers()">
          </shared-videos-grid>
        }
        
        @case ('scenes') {
          <shared-scenes-grid
            [scenes]="currentScenes"
            [selectedSceneId]="currentScene?.id"
            [clientType]="'remote'"
            [showBreadcrumb]="true"
            (sceneSelected)="navigateToScene($event)"
            (backToVideos)="navigateToVideo(currentVideo ? currentVideo.id : '')">
          </shared-scenes-grid>
        }
        
        @case ('scene-selected') {
          <video-controls
            [currentVideo]="getCurrentVideo()"
            [currentScene]="getCurrentScene()"
            [sceneId]="currentScene?.id"
            [isPlaying]="isPlaying"
            [isMuted]="isMuted"
            [volumeLevel]="volumeLevel"
            [hasPreviousScene]="hasPreviousScene()"
            [hasNextScene]="hasNextScene()"
            (controlCommand)="sendControlCommand($event)"
            (volumeChange)="onVolumeChange($event)"
            (backToScenes)="navigateToScenes(currentVideo?.id ?? '')">
          </video-controls>
        }
      }
    </div>
  }
</div>

<router-outlet />
